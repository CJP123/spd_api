[
  {
    "objectID": "CHANGELOG.html",
    "href": "CHANGELOG.html",
    "title": "spd_api",
    "section": "",
    "text": "no notes# Release notes"
  },
  {
    "objectID": "CHANGELOG.html#section",
    "href": "CHANGELOG.html#section",
    "title": "spd_api",
    "section": "0.0.7",
    "text": "0.0.7"
  },
  {
    "objectID": "spd.html",
    "href": "spd.html",
    "title": "EA SPD",
    "section": "",
    "text": "extract_spd_list\n\n extract_spd_list (year)\n\nGet list of available downloads from the casefiles\n\nextract_spd_list(2022)\n\n\n\n\n\n  \n    \n      \n      Name\n      Date modified\n      File size\n      file_size\n    \n    \n      file_date\n      \n      \n      \n      \n    \n  \n  \n    \n      2022-01-01\n      MSS_311112021121100996_0X.ZIP\n      01 Jan 2022\n      6,380 KB\n      6380\n    \n    \n      2022-01-02\n      MSS_11112022011100274_0X.ZIP\n      04 Jan 2022\n      6,426 KB\n      6426\n    \n    \n      2022-01-03\n      MSS_21112022011100481_0X.ZIP\n      03 Jan 2022\n      6,457 KB\n      6457\n    \n    \n      2022-01-04\n      MSS_31112022011100206_0X.ZIP\n      04 Jan 2022\n      6,458 KB\n      6458\n    \n    \n      2022-01-05\n      MSS_41112022011100952_0X.ZIP\n      05 Jan 2022\n      6,453 KB\n      6453\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      2022-08-06\n      MSS_51112022081200827_0X.ZIP\n      07 Aug 2022\n      6,100 KB\n      6100\n    \n    \n      2022-08-07\n      MSS_61112022081200811_0X.ZIP\n      07 Aug 2022\n      6,083 KB\n      6083\n    \n    \n      2022-08-08\n      MSS_71112022081200614_0X.ZIP\n      08 Aug 2022\n      6,165 KB\n      6165\n    \n    \n      2022-08-09\n      MSS_81112022081200441_0X.ZIP\n      09 Aug 2022\n      6,219 KB\n      6219\n    \n    \n      2022-08-10\n      MSS_91112022081200157_0X.ZIP\n      10 Aug 2022\n      6,245 KB\n      6245\n    \n  \n\n222 rows × 4 columns\n\n\n\nTest operation with one day\n\navailable_days = extract_spd_list(2022)\nzip_file = httpx.get(f'https://www.emi.ea.govt.nz/Wholesale/Datasets/FinalPricing/CaseFiles/2022/{available_days.iloc[0].Name}', follow_redirects=True)\nfile = ZipFile(BytesIO(zip_file.content))\n_bus(file)\n\n\n\n\n\n  \n    \n      \n      INTERVAL\n      ID_BUS\n      ID_ST\n      LOAD\n      GENERATION\n    \n  \n  \n    \n      0\n      2022-01-01 00:00:00\n      100\n      MVE\n      0.000000\n      0.0000\n    \n    \n      1\n      2022-01-01 00:00:00\n      101\n      MVE\n      0.000000\n      0.0000\n    \n    \n      2\n      2022-01-01 00:00:00\n      102\n      RTO\n      0.000000\n      0.0000\n    \n    \n      3\n      2022-01-01 00:00:00\n      103\n      CBG\n      19.943001\n      0.0000\n    \n    \n      4\n      2022-01-01 00:00:00\n      104\n      CBG\n      0.000000\n      0.0000\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      939\n      2022-01-01 23:30:00\n      95\n      ARI\n      0.000000\n      4.9120\n    \n    \n      940\n      2022-01-01 23:30:00\n      96\n      ARI\n      0.000000\n      15.3333\n    \n    \n      941\n      2022-01-01 23:30:00\n      97\n      ARI\n      0.000000\n      15.3333\n    \n    \n      942\n      2022-01-01 23:30:00\n      98\n      ARI\n      0.000000\n      15.3333\n    \n    \n      943\n      2022-01-01 23:30:00\n      99\n      ARI\n      0.000000\n      0.0000\n    \n  \n\n45014 rows × 5 columns\n\n\n\nWant to speed up downloads - use httpx async\n\n\n\nmain_spd\n\n main_spd (spd_df, year)\n\n\n\n\nget_spd\n\n get_spd (client, url)\n\nConnect and download a month at a time\n\nmonth, year = 1 , 2022\nspd_df = extract_spd_list(year)\nbranch, bus = await main_spd(spd_df.loc[f'{year}-{month}'], year)\n\n2022\n\n\n(                INTERVAL               BRANCHNAME FROM_STATION TO_STATION  \\\n 0    2022-01-01 00:00:00         ABY     MXT1MXT1          ABY        ABY   \n 1    2022-01-01 00:00:00           ABY     T2  T2          ABY        ABY   \n 2    2022-01-01 00:00:00  ALB     ALB_HEN3      1          ALB        HEN   \n 3    2022-01-01 00:00:00  ALB     ALB_HPI1      1          ALB        HPI   \n 4    2022-01-01 00:00:00  ALB     ALB_SVL1      1          ALB        SVL   \n ...                  ...                      ...          ...        ...   \n 1077 2022-01-31 23:30:00           WTU     T4  T4          WTU        WTU   \n 1078 2022-01-31 23:30:00         WVY     MXT1MXT1          WVY        WVY   \n 1079 2022-01-31 23:30:00           WVY     T1  T1          WVY        WVY   \n 1080 2022-01-31 23:30:00           WWD     T1  T1          WWD        WWD   \n 1081 2022-01-31 23:30:00           WWD     T2  T2          WWD        WWD   \n \n         FROM_MW      TO_MW  BRANCHLOSSES  \n 0      0.000000   0.000000       0.00000  \n 1     -4.597000  -4.606000       0.01446  \n 2    -18.837000 -18.860001       0.02267  \n 3     13.488000  13.478000       0.00905  \n 4     14.881000  14.872000       0.00912  \n ...         ...        ...           ...  \n 1077  19.447001  19.407000       0.06421  \n 1078   0.000000   0.000000       0.00000  \n 1079   2.808000   2.799000       0.01193  \n 1080  -0.318000  -0.318000       0.00000  \n 1081  -2.753000  -2.753000       0.00000  \n \n [1612512 rows x 7 columns],\n                INTERVAL ID_BUS ID_ST       LOAD  GENERATION\n 0   2022-01-01 00:00:00    100   MVE   0.000000      0.0000\n 1   2022-01-01 00:00:00    101   MVE   0.000000      0.0000\n 2   2022-01-01 00:00:00    102   RTO   0.000000      0.0000\n 3   2022-01-01 00:00:00    103   CBG  19.943001      0.0000\n 4   2022-01-01 00:00:00    104   CBG   0.000000      0.0000\n ..                  ...    ...   ...        ...         ...\n 930 2022-01-31 23:30:00     95   ARI   0.000000     15.3333\n 931 2022-01-31 23:30:00     96   ARI   0.000000     15.3333\n 932 2022-01-31 23:30:00     97   ARI   0.000000     15.3333\n 933 2022-01-31 23:30:00     98   ARI   0.000000      0.0000\n 934 2022-01-31 23:30:00     99   MVE   0.000000      0.0000\n \n [1392881 rows x 5 columns])"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "SPD API",
    "section": "",
    "text": "Install using:\npip install spd_api"
  },
  {
    "objectID": "index.html#this-is-a-basic-interface-with-the-ea-web-files-to-extract-data",
    "href": "index.html#this-is-a-basic-interface-with-the-ea-web-files-to-extract-data",
    "title": "SPD API",
    "section": "This is a basic interface with the EA web files to extract data",
    "text": "This is a basic interface with the EA web files to extract data\nWe can choose a year and get a dataframe of the available files:\n\nextract_spd_list(2020)\n\n\n\n\n\n  \n    \n      \n      Name\n      Date modified\n      File size\n      file_size\n    \n    \n      file_date\n      \n      \n      \n      \n    \n  \n  \n    \n      2020-01-01\n      MSS_311112019121100875_0X.ZIP\n      02 Jan 2020\n      6,340 KB\n      6340\n    \n    \n      2020-01-02\n      MSS_11112020011100861_0X.ZIP\n      02 Jan 2020\n      6,350 KB\n      6350\n    \n    \n      2020-01-03\n      MSS_21112020011100145_0X.ZIP\n      05 Jan 2020\n      6,378 KB\n      6378\n    \n    \n      2020-01-04\n      MSS_31112020011100230_0X.ZIP\n      06 Jan 2020\n      6,378 KB\n      6378\n    \n    \n      2020-01-05\n      MSS_41112020011100102_0X.ZIP\n      05 Jan 2020\n      6,382 KB\n      6382\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      2020-12-27\n      MSS_261112020121100745_0X.ZIP\n      28 Dec 2020\n      6,375 KB\n      6375\n    \n    \n      2020-12-28\n      MSS_271112020121100873_0X.ZIP\n      29 Dec 2020\n      6,382 KB\n      6382\n    \n    \n      2020-12-29\n      MSS_281112020121100340_0X.ZIP\n      29 Dec 2020\n      6,389 KB\n      6389\n    \n    \n      2020-12-30\n      MSS_291112020121100051_0X.ZIP\n      30 Dec 2020\n      6,390 KB\n      6390\n    \n    \n      2020-12-31\n      MSS_301112020121100813_0X.ZIP\n      31 Dec 2020\n      6,388 KB\n      6388\n    \n  \n\n366 rows × 4 columns\n\n\n\nMore practically is to list a month and a year (due to size issues) and this will return the bus and branch data\n\nmonth, year = 1 , 2022\nspd_df = extract_spd_list(year)\nawait main_spd(spd_df.loc[f'{year}-{month}'], year)\n\n(                INTERVAL               BRANCHNAME FROM_STATION TO_STATION  \\\n 0    2022-01-01 00:00:00         ABY     MXT1MXT1          ABY        ABY   \n 1    2022-01-01 00:00:00           ABY     T2  T2          ABY        ABY   \n 2    2022-01-01 00:00:00  ALB     ALB_HEN3      1          ALB        HEN   \n 3    2022-01-01 00:00:00  ALB     ALB_HPI1      1          ALB        HPI   \n 4    2022-01-01 00:00:00  ALB     ALB_SVL1      1          ALB        SVL   \n ...                  ...                      ...          ...        ...   \n 1077 2022-01-31 23:30:00           WTU     T4  T4          WTU        WTU   \n 1078 2022-01-31 23:30:00         WVY     MXT1MXT1          WVY        WVY   \n 1079 2022-01-31 23:30:00           WVY     T1  T1          WVY        WVY   \n 1080 2022-01-31 23:30:00           WWD     T1  T1          WWD        WWD   \n 1081 2022-01-31 23:30:00           WWD     T2  T2          WWD        WWD   \n \n         FROM_MW      TO_MW  BRANCHLOSSES  \n 0      0.000000   0.000000       0.00000  \n 1     -4.597000  -4.606000       0.01446  \n 2    -18.837000 -18.860001       0.02267  \n 3     13.488000  13.478000       0.00905  \n 4     14.881000  14.872000       0.00912  \n ...         ...        ...           ...  \n 1077  19.447001  19.407000       0.06421  \n 1078   0.000000   0.000000       0.00000  \n 1079   2.808000   2.799000       0.01193  \n 1080  -0.318000  -0.318000       0.00000  \n 1081  -2.753000  -2.753000       0.00000  \n \n [1612512 rows x 7 columns],\n                INTERVAL ID_BUS ID_ST       LOAD  GENERATION\n 0   2022-01-01 00:00:00    100   MVE   0.000000      0.0000\n 1   2022-01-01 00:00:00    101   MVE   0.000000      0.0000\n 2   2022-01-01 00:00:00    102   RTO   0.000000      0.0000\n 3   2022-01-01 00:00:00    103   CBG  19.943001      0.0000\n 4   2022-01-01 00:00:00    104   CBG   0.000000      0.0000\n ..                  ...    ...   ...        ...         ...\n 930 2022-01-31 23:30:00     95   ARI   0.000000     15.3333\n 931 2022-01-31 23:30:00     96   ARI   0.000000     15.3333\n 932 2022-01-31 23:30:00     97   ARI   0.000000     15.3333\n 933 2022-01-31 23:30:00     98   ARI   0.000000      0.0000\n 934 2022-01-31 23:30:00     99   MVE   0.000000      0.0000\n \n [1392881 rows x 5 columns])"
  }
]